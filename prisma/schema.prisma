generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// NextAuth Models
model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  role          String    @default("USER") // ADMIN, USER, GUEST
  accounts      Account[]
  sessions      Session[]
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

// Zee-Index Models
model ActivityLog {
  id            String   @id @default(cuid())
  type          String
  timestamp     Float
  severity      String   // info, warning, error, critical
  
  // Details
  itemName      String?
  itemId        String?
  itemSize      String?
  itemType      String?
  userEmail     String?
  userId        String?
  userRole      String?
  targetUser    String?
  destinationFolder String?
  sourcePath    String?
  targetPath    String?
  status        String?
  error         String?
  errorCode     String?
  ipAddress     String?
  userAgent     String?
  country       String?
  city          String?
  metadata      String?  // JSON string
}

model ShareLink {
  id            String   @id @default(cuid()) // same as jti
  path          String
  token         String   @unique
  jti           String   @unique
  expiresAt     DateTime
  loginRequired Boolean  @default(false)
  itemName      String
  isCollection  Boolean  @default(false)
  views         Int      @default(0)
  createdAt     DateTime @default(now())
}

model ProtectedFolder {
  id        String   @id @default(cuid())
  folderId  String   @unique
  password  String?  // Hashed password if protected by password
  createdAt DateTime @default(now())
}

model AdminConfig {
  key   String @id
  value String // JSON string representation
}
